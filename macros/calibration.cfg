# WARNING: DO NOT EDIT THIS FILE
# To override settings from this file, you can copy and paste the relevant
# sections into your printer.cfg and change it there.

[gcode_macro PID_CALIBRATE_HOTEND]
description: Perform a PID calibration test for a given extruder heater.
gcode:
	# parameter
	{% set temp = params.TEMP|default(220)|int %}

	DEBUG_ECHO PREFIX="PID_CALIBRATE_HOTEND" MSG="TEMP={temp}"

	# caibrate hotend heater
	{% if printer["dual_carriage"] is not defined %}
		# DEFAULT
		RATOS_ECHO MSG="PID calibration hotend heater T0..."
		PID_CALIBRATE HEATER=extruder TARGET={temp}
	{% else %}
		# IDEX
		{% set t = params.TOOLHEAD|default(-1)|int %}
		{% if t==0 or t==1 %}
			RATOS_ECHO MSG="PID calibration hotend heater T{t}..."
			PID_CALIBRATE HEATER=extruder{'' if t==0 else t} TARGET={temp}
		{% else %}
			RATOS_ECHO MSG="Please select toolhead! 0 = left, 1 = right toolhead"
		{% endif %}
	{% endif %}


[gcode_macro PID_CALIBRATE_BED]
description: Perform a PID calibration test for the bed heater.
gcode:
	# parameter
	{% set temp = params.TEMP|default(80)|int %}

	DEBUG_ECHO PREFIX="PID_CALIBRATE_BED" MSG="TEMP={temp}"
	RATOS_ECHO MSG="PID calibration bed heater..."

	# caibrate bed heater
	PID_CALIBRATE HEATER=heater_bed TARGET={temp}


[gcode_macro START_PA_TOWER]
description: Start a pressure advance tuning tower.
gcode:
	# parameter
	{% set start = params.START|default(0.0)|float %}
	{% set factor = params.FACTOR|default(0.001)|float %}

	DEBUG_ECHO PREFIX="START_PA_TOWER" MSG="START={start}, FACTOR={factor}"
	RATOS_ECHO MSG="Starting presssure advance tuning tower..."

	TUNING_TOWER COMMAND=SET_PRESSURE_ADVANCE PARAMETER=ADVANCE START={start} FACTOR={factor}
